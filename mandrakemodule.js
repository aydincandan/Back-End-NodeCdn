let modulFUNCmdk=(e,l)=>{let t=(e,o)=>{if(null!==e&&"object"==typeof e)for(var n in e)"number"!=typeof e[n]&&"function"!=typeof e[n]&&(console.log("\t",typeof e[n],{key:n},"Buffer"===e[n]?.type,Array.isArray(e[n]?.data),Array.isArray(e[n])),Array.isArray(e[n])&&(e[n].data=o(e[n].data)),"object"==typeof e[n])&&t(e[n],o)};let i=(e,o,n)=>{var t=[];let r=[e];for(var a=new Set;0<r.length;){var i=r.pop();if("object"==typeof i&&null!==i){if(!a.has(i))for(var l in a.add(i),i)l===o?(t.push(i[l]),i[l]=n(i[l])):r.push(i[l])}else Array.isArray(i)&&i.forEach(e=>r.push(e))}return t};return{zamanDamgasi:()=>{var e=new Date;return`${e.getFullYear()}.${String(e.getMonth()+1).padStart(2,"0")}.${String(e.getDate()).padStart(2,"0")}-${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}:${String(e.getSeconds()).padStart(2,"0")}:`+String(e.getMilliseconds()).padStart(3,"0")},newFormData:async(e,o)=>{let r=new FormData;if(e)for(var[n,t]of Object.entries(e))r.append(n,t);if(o)for(var a of o){var i=await(async e=>{let o=!0;if(e.buffer){o=!1;var n=new Blob([e.buffer],{type:e.mimetype});r.append("attachments",n,e.originalname),console.log("formData.append('attachments', blob, ",e.originalname)}else if(e.redisKey){o=!1,console.log("========== ŞİMDİ BU DURUMU TEST ET ========="),process.exit(1);try{var t=await myredis.getAsync(e.redisKey);e.buffer=new Blob([t],{type:e.mimetype}),e.buffer=Buffer.from(t),r.append("attachments",e.buffer,e.originalname),console.log("redisten okunan dosya->",e.buffer)}catch(e){console.log("redisKey TTL ile zaman asimina ugramis olabiir.",e)}finally{console.log("- - - - - - - - - - - - - -")}}return o})(a);1==i&&(i=l.readFileSync(a.path),i=new Blob([i],{type:a.mimetype}),r.append("attachments",i,a.originalname))}else console.log("========== Ve cikis ===========",o.length),console.log("newFormData",{formData:r}),console.log("========== Ve cikis ===========",o.length);return r},response_final:(e,o,n,t,r)=>{var a={};if(a.response_final={status:n,kimden3:e.headers["x-nerden"],req_originalUrl:e.originalUrl,final_data:t},500!=n)try{i(a,"buffer",e=>e.slice(0,5))}catch(e){}return console.log("_^_^_^_^_^_^_^_^_^_^_^_^"),r&&console.log("response_final->",{verbose:r},n,a),console.log("status:",n),console.log(""),console.log(""),console.log("Browser'a dönüş yapildi Via mandrakemodule.js"),console.log(""),console.log(""),console.log("=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|=|"),o.status(n).json(a)},isBrowser:function(){return"undefined"!=typeof window&&void 0!==window.document},isNode:function(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node},isElectron:function(){return"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.electron},findAndModifyBuffer:t,GetValiumOptimized:function(e,o){var n=[];let t=[e];for(var r=new Set;0<t.length;){var a=t.pop();if("object"==typeof a&&null!==a){if(!r.has(a))for(var i in r.add(a),a)(i===o?n:t).push(a[i])}else Array.isArray(a)&&a.forEach(e=>t.push(e))}return n},findOneModify:i,Mandrake:(e,o,n)=>{let r=document.getElementById(e);var e=window.location.origin,t=window.location.protocol,a=window.location.hostname,i=window.location.port;let{prod_server_origin:l,prod_client_origin:s,mndrk_Actions:c}=n,d=e=>new URL(e).origin,f=!1,u=!1,g=(e==d(t+"localhost:"+i)?f=!0:u=!0,!1),p=!1;e==s?p=!0:g=!0,console.log({LOCA:f}),console.log(e,d(t+"localhost:"+i)),console.log({REMO:u}),console.log("------"),console.log({TEST:g}),console.log(1,{docClientOrigin:e}),console.log(2,{prod_client_origin:s}),console.log(3,{prod_server_origin:l}),console.log({PROD:p}),console.log("------");n={PROD:p,TEST:g,REMO:u,LOCA:f,docClientOrigin:e,docClientProtocol:t,docClientHostname:a,docClientPort:i},console.log({RETURNS:n}),e=r.getAttribute("data-mndrk_Actions");let m;if(e)try{m=JSON.parse(e),console.log("Data Actions Array:",m)}catch(e){console.error("data-mndrk_Actions JSON formatında değil:",e)}else m=c;Array.isArray(m)&&m.forEach((e,o,n)=>{1==f&&1==g?n[o]=e:1==u&&1==p?n[o]=e.replace(d(e),l):n[o]="action bilinmiyor"}),document.getElementById("selectedRedActionDiv")||((t=document.createElement("div")).id="selectedRedActionDiv",t.style="color:red",r.after(t));let y=document.getElementById("selectedRedActionDiv");if(y&&(y.innerText=m[0],r.action=m[0]),!document.getElementById("actions")){let t=document.createElement("select");t.id="actions",t.name="actions",y.before(t),Array.isArray(m)&&m.forEach((e,o)=>{var n=document.createElement("option");n.id="URL"+(o+1),n.value=e,n.innerText=`LOCAL: ${f} ve TEST: ${g} | `+e,t.add(n)}),t.addEventListener("change",e=>{e=e.target.value;y.innerText=e,r.action=e})}a=document.getElementById(o);let v=a||document.createElement("textarea");return a||(v.class="feedback",v.name="feedback",v.id="feedback",v.rows="50",v.style="font-size: 15px; width:100%; margin:0px",y.after(v)),r.addEventListener("submit",async e=>{e.preventDefault();try{var o=XanaduForclient(r),n=(v.innerHTML="Xanadu BEKLENİYOR... "+o.url,console.log("mandrake -> XanaduForclient : ",{xfc:o}),document.querySelector('input[name="agent1"]:checked')?.value);Xanadu(n,o.url,o.FetchSendOptions,o.AxiosSendData,o.AxiosSendOptions).then(e=>{console.log(e),v.innerHTML=JSON.stringify(e,null,4).replace(/<br\s*\/?>/gi,"\n").replace(/\\n /gi,"\n\t")}).catch(e=>{console.log(e);var o=JSON.stringify(e,null,4).replace(/<br\s*\/?>/gi,"\n").replace(/\\n /gi,"\n\t");v.innerHTML="{}"==o?String(e):o})}catch(e){return alert(e),e}}),n}}};((e,o)=>{"function"==typeof define&&define.amd?define(["fs"],o):"object"==typeof module&&"object"==typeof module.exports?module.exports=o(require("fs")):e.mandrakemodule=o(e.fs)})("undefined"!=typeof window?window:this,modulFUNCmdk);